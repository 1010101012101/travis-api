language: ruby

sudo: false

rvm: 2.5.1

env:
  - CONCURRENCY=4

before_script:
  - 'RAILS_ENV=test bundle exec rake db:create --trace'
  - 'RAILS_ENV=test bundle exec rake db:prepare:parallel'

script: "bundle exec parallel_test spec -n $CONCURRENCY --type rspec"

cache: bundler

addons:
  postgresql: 9.6

services:
  - redis-server
